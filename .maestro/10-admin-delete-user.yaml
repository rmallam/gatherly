appId: com.guestscanner.app
---
# Test: Admin Delete User
- launchApp:
    clearState: true

# Wait for app to load
- extendedWaitUntil:
    visible: "Sign In"
    timeout: 30000

# Handle notification permission
- runFlow:
    when:
      visible: "Allow"
    commands:
      - tapOn: "Allow"
      - waitForAnimationToEnd

# Login as admin
- tapOn:
    text: "your@email.com"
- inputText: "mallamrakeshkumar@gmail.com"
- tapOn:
    text: "Enter your password"
- inputText: "Rakeshkumar@123"
- tapOn: "Sign In"
- waitForAnimationToEnd

# Wait for dashboard
- extendedWaitUntil:
    visible: "My Events"
    timeout: 20000

# Take screenshot to debug shield icon position
- takeScreenshot: "dashboard-before-admin-tap"

# Try multiple positions to find the shield icon
# Position 1: Far right, slightly lower
- runFlow:
    when:
      visible: "My Events"
    commands:
      - tapOn:
          point: "95%,10%"
      - waitForAnimationToEnd:
          timeout: 2000

# Check if we're on admin dashboard
- runFlow:
    when:
      notVisible: "Admin Dashboard"
    commands:
      # Position 2: More centered right
      - tapOn:
          point: "88%,8%"
      - waitForAnimationToEnd:
          timeout: 2000

# Check again
- runFlow:
    when:
      notVisible: "Admin Dashboard"
    commands:
      # Position 3: Try tapping on the profile/header area and look for admin option
      - tapOn:
          point: "75%,8%"
      - waitForAnimationToEnd:
          timeout: 2000

# Search for test user
- tapOn:
    text: "Search by name, email, or phone..."
- inputText: "testuser@test.com"
- waitForAnimationToEnd

# Should see the test user in results
- assertVisible: "testuser@test.com"

# Tap delete button (trash icon) for the user
# The delete button is in the same row as the user
- tapOn:
    id: ".*delete.*"
- waitForAnimationToEnd

# Confirm deletion in modal
- assertVisible: "Delete User"
- assertVisible: "Are you sure"
- tapOn: "Delete"
- waitForAnimationToEnd

# User should be removed from list
- assertNotVisible: "testuser@test.com"

# Success!
